"<br>Ratio: ", round(QuanQualRatio, 2)),
hoverinfo = "text") |>
plotly::layout(title = 'Quan-to-Qual Ratio',
xaxis = list(title = 'Replicate Name'),
yaxis = list(title = 'Quan-to-Qual Ratio'))
View(Skyline_output_filt)
#     plotly::plot_ly(x = ~Replicate_Name, y = ~QuanQualRatio, type = 'violin', color = ~Sample_Type,
#             text = ~paste("Sample: ", Replicate_Name,
#                           "<br>Molecule List: ", Molecule_List,
#                           "<br>Molecule: ", Molecule,
#                           "<br>Quan/Qual MZ: ", QuanQualMZ,
#                           "<br>Ratio: ", round(QuanQualRatio, 2)),
#             hoverinfo = "text") |>
#     plotly::layout(title = 'Quan-to-Qual Ratio',
#            xaxis = list(title = 'Replicate Name'),
#            yaxis = list(title = 'Quan-to-Qual Ratio'))
test <- Skyline_output_filt |>
dplyr::group_by(Replicate_Name, Molecule) |>
dplyr::mutate(Quan_Area = ifelse(Isotope_Label_Type == "Quan", Area, NA)) |>
tidyr::fill(Quan_Area, .direction = "downup") |>
dplyr::mutate(QuanMZ = ifelse(Isotope_Label_Type == "Quan", Chromatogram_Precursor_MZ, NA)) |>
tidyr::fill(QuanMZ, .direction = "downup") |>
dplyr::mutate(QuanQualRatio = ifelse(Isotope_Label_Type == "Qual", Quan_Area/Area, 1)) |>
tidyr::replace_na(list(QuanQualRatio = 0)) |>
dplyr::mutate(QuanQualMZ = paste0(QuanMZ,"/",Chromatogram_Precursor_MZ)) |>
dplyr::ungroup() |>
dplyr::select(Replicate_Name, Sample_Type, Molecule_List, Molecule, QuanQualMZ, QuanQualRatio) |>
plotly::plot_ly(x = ~Replicate_Name, y = ~QuanQualRatio, type = 'violin', color = ~Sample_Type,
text = ~paste("Sample: ", Replicate_Name,
"<br>Molecule List: ", Molecule_List,
"<br>Molecule: ", Molecule,
"<br>Quan/Qual MZ: ", QuanQualMZ,
"<br>Ratio: ", round(QuanQualRatio, 2)),
hoverinfo = "text") |>
plotly::layout(title = 'Quan-to-Qual Ratio',
xaxis = list(title = 'Replicate Name'),
yaxis = list(title = 'Quan-to-Qual Ratio'))
#     plotly::plot_ly(x = ~Replicate_Name, y = ~QuanQualRatio, type = 'violin', color = ~Sample_Type,
#             text = ~paste("Sample: ", Replicate_Name,
#                           "<br>Molecule List: ", Molecule_List,
#                           "<br>Molecule: ", Molecule,
#                           "<br>Quan/Qual MZ: ", QuanQualMZ,
#                           "<br>Ratio: ", round(QuanQualRatio, 2)),
#             hoverinfo = "text") |>
#     plotly::layout(title = 'Quan-to-Qual Ratio',
#            xaxis = list(title = 'Replicate Name'),
#            yaxis = list(title = 'Quan-to-Qual Ratio'))
test <- Skyline_output_filt |>
dplyr::group_by(Replicate_Name, Molecule) |>
dplyr::mutate(Quan_Area = ifelse(Isotope_Label_Type == "Quan", Area, NA)) |>
tidyr::fill(Quan_Area, .direction = "downup") |>
dplyr::mutate(QuanMZ = ifelse(Isotope_Label_Type == "Quan", Chromatogram_Precursor_MZ, NA)) |>
tidyr::fill(QuanMZ, .direction = "downup") |>
dplyr::mutate(QuanQualRatio = ifelse(Isotope_Label_Type == "Qual", Quan_Area/Area, 1)) |>
tidyr::replace_na(list(QuanQualRatio = 0)) |>
dplyr::mutate(QuanQualMZ = paste0(QuanMZ,"/",Chromatogram_Precursor_MZ)) |>
dplyr::ungroup() |>
dplyr::select(Replicate_Name, Sample_Type, Molecule_List, Molecule, QuanQualMZ, QuanQualRatio)
View(test)
test <- Skyline_output_filt |>
dplyr::group_by(Replicate_Name, Molecule) |>
dplyr::mutate(Quan_Area = ifelse(Isotope_Label_Type == "Quan", Area, NA)) |>
tidyr::fill(Quan_Area, .direction = "downup") |>
dplyr::mutate(QuanMZ = ifelse(Isotope_Label_Type == "Quan", Chromatogram_Precursor_MZ, NA)) |>
tidyr::fill(QuanMZ, .direction = "downup") |>
dplyr::mutate(QuanQualRatio = ifelse(Isotope_Label_Type == "Qual", Quan_Area/Area, 1)) |>
tidyr::replace_na(list(QuanQualRatio = 0)) |>
dplyr::mutate(QuanQualMZ = paste0(QuanMZ,"/",Chromatogram_Precursor_MZ)) |>
dplyr::ungroup()
View(test)
#     plotly::plot_ly(x = ~Replicate_Name, y = ~QuanQualRatio, type = 'violin', color = ~Sample_Type,
#             text = ~paste("Sample: ", Replicate_Name,
#                           "<br>Molecule List: ", Molecule_List,
#                           "<br>Molecule: ", Molecule,
#                           "<br>Quan/Qual MZ: ", QuanQualMZ,
#                           "<br>Ratio: ", round(QuanQualRatio, 2)),
#             hoverinfo = "text") |>
#     plotly::layout(title = 'Quan-to-Qual Ratio',
#            xaxis = list(title = 'Replicate Name'),
#            yaxis = list(title = 'Quan-to-Qual Ratio'))
test <- Skyline_output_filt |>
dplyr::group_by(Replicate_Name, Molecule) |>
dplyr::mutate(Quan_Area = ifelse(Isotope_Label_Type == "Quan", Area, NA)) |>
tidyr::fill(Quan_Area, .direction = "downup") |>
dplyr::mutate(QuanMZ = ifelse(Isotope_Label_Type == "Quan", Chromatogram_Precursor_MZ, NA)) |>
tidyr::fill(QuanMZ, .direction = "downup") |>
dplyr::mutate(QuanQualRatio = ifelse(Isotope_Label_Type == "Qual", Quan_Area/Area, 1)) |>
tidyr::replace_na(list(QuanQualRatio = 0)) |>
dplyr::mutate(QuanQualMZ = paste0(QuanMZ,"/",Chromatogram_Precursor_MZ)) |>
dplyr::mutate(Quan_Rel_Ab = ifelse(Isotope_Label_Type == "Quan", Rel_Ab, NA)) |>
tidyr::fill(Quan_Rel_Ab, .direction = "downup") |>
dplyr::mutate(QuanQual_Rel_Ab_Ratio = ifelse(Isotope_Label_Type == "Qual", Quan_Rel_Ab/Rel_Ab, 1)) |>
tidyr::replace_na(list(QuanQual_Rel_Ab_Ratio = 0)) |>
dplyr::ungroup() |>
dplyr::select(Replicate_Name, Sample_Type, Molecule_List, Molecule, QuanQualMZ, QuanQualRatio)
View(test)
#     plotly::plot_ly(x = ~Replicate_Name, y = ~QuanQualRatio, type = 'violin', color = ~Sample_Type,
#             text = ~paste("Sample: ", Replicate_Name,
#                           "<br>Molecule List: ", Molecule_List,
#                           "<br>Molecule: ", Molecule,
#                           "<br>Quan/Qual MZ: ", QuanQualMZ,
#                           "<br>Ratio: ", round(QuanQualRatio, 2)),
#             hoverinfo = "text") |>
#     plotly::layout(title = 'Quan-to-Qual Ratio',
#            xaxis = list(title = 'Replicate Name'),
#            yaxis = list(title = 'Quan-to-Qual Ratio'))
test <- Skyline_output_filt |>
dplyr::group_by(Replicate_Name, Molecule) |>
dplyr::mutate(Quan_Area = ifelse(Isotope_Label_Type == "Quan", Area, NA)) |>
tidyr::fill(Quan_Area, .direction = "downup") |>
dplyr::mutate(QuanMZ = ifelse(Isotope_Label_Type == "Quan", Chromatogram_Precursor_MZ, NA)) |>
tidyr::fill(QuanMZ, .direction = "downup") |>
dplyr::mutate(QuanQualRatio = ifelse(Isotope_Label_Type == "Qual", Quan_Area/Area, 1)) |>
tidyr::replace_na(list(QuanQualRatio = 0)) |>
dplyr::mutate(QuanQualMZ = paste0(QuanMZ,"/",Chromatogram_Precursor_MZ)) |>
dplyr::mutate(Quan_Rel_Ab = ifelse(Isotope_Label_Type == "Quan", Rel_Ab, NA)) |>
tidyr::fill(Quan_Rel_Ab, .direction = "downup") |>
dplyr::mutate(QuanQual_Rel_Ab_Ratio = ifelse(Isotope_Label_Type == "Qual", Quan_Rel_Ab/Rel_Ab, 1)) |>
tidyr::replace_na(list(QuanQual_Rel_Ab_Ratio = 0)) |>
dplyr::ungroup() |>
dplyr::select(Replicate_Name, Sample_Type, Molecule_List, Molecule, QuanQualMZ, QuanQualRatio, QuanQual_Rel_Ab_Ratio)
View(test)
dput(head(test))
#     plotly::plot_ly(x = ~Replicate_Name, y = ~QuanQualRatio, type = 'violin', color = ~Sample_Type,
#             text = ~paste("Sample: ", Replicate_Name,
#                           "<br>Molecule List: ", Molecule_List,
#                           "<br>Molecule: ", Molecule,
#                           "<br>Quan/Qual MZ: ", QuanQualMZ,
#                           "<br>Ratio: ", round(QuanQualRatio, 2)),
#             hoverinfo = "text") |>
#     plotly::layout(title = 'Quan-to-Qual Ratio',
#            xaxis = list(title = 'Replicate Name'),
#            yaxis = list(title = 'Quan-to-Qual Ratio'))
test <- Skyline_output_filt |>
dplyr::group_by(Replicate_Name, Molecule) |>
dplyr::mutate(Quan_Area = ifelse(Isotope_Label_Type == "Quan", Area, NA)) |>
tidyr::fill(Quan_Area, .direction = "downup") |>
dplyr::mutate(QuanMZ = ifelse(Isotope_Label_Type == "Quan", Chromatogram_Precursor_MZ, NA)) |>
tidyr::fill(QuanMZ, .direction = "downup") |>
dplyr::mutate(QuanQualRatio = ifelse(Isotope_Label_Type == "Qual", Quan_Area/Area, 1)) |>
tidyr::replace_na(list(QuanQualRatio = 0)) |>
dplyr::mutate(QuanQualMZ = paste0(QuanMZ,"/",Chromatogram_Precursor_MZ)) |>
dplyr::mutate(Quan_Rel_Ab = ifelse(Isotope_Label_Type == "Quan", Rel_Ab, NA)) |>
tidyr::fill(Quan_Rel_Ab, .direction = "downup") |>
dplyr::mutate(QuanQual_Rel_Ab_Ratio = ifelse(Isotope_Label_Type == "Qual", Quan_Rel_Ab/Rel_Ab, 1)) |>
tidyr::replace_na(list(QuanQual_Rel_Ab_Ratio = 0)) |>
dplyr::ungroup() |>
dplyr::select(Replicate_Name, Sample_Type, Molecule_List, Molecule, QuanQualMZ, QuanQualRatio, QuanQual_Rel_Ab_Ratio) |>
plotly::plot_ly(x = ~Replicate_Name, y = ~QuanQualRatio/QuanQual_Rel_Ab_Ratio, type = 'violin', color = ~Sample_Type,
text = ~paste("Sample: ", Replicate_Name,
"<br>Molecule List: ", Molecule_List,
"<br>Molecule: ", Molecule,
"<br>Quan/Qual MZ: ", QuanQualMZ,
"<br>Ratio: ", round(QuanQualRatio/QuanQual_Rel_Ab_Ratio, 2)),
hoverinfo = "text") |>
plotly::layout(title = 'Ratio',
xaxis = list(title = 'Replicate Name'),
yaxis = list(title = 'Ratio'))
#     plotly::plot_ly(x = ~Replicate_Name, y = ~QuanQualRatio, type = 'violin', color = ~Sample_Type,
#             text = ~paste("Sample: ", Replicate_Name,
#                           "<br>Molecule List: ", Molecule_List,
#                           "<br>Molecule: ", Molecule,
#                           "<br>Quan/Qual MZ: ", QuanQualMZ,
#                           "<br>Ratio: ", round(QuanQualRatio, 2)),
#             hoverinfo = "text") |>
#     plotly::layout(title = 'Quan-to-Qual Ratio',
#            xaxis = list(title = 'Replicate Name'),
#            yaxis = list(title = 'Quan-to-Qual Ratio'))
test <- Skyline_output_filt |>
dplyr::group_by(Replicate_Name, Molecule) |>
dplyr::mutate(Quan_Area = ifelse(Isotope_Label_Type == "Quan", Area, NA)) |>
tidyr::fill(Quan_Area, .direction = "downup") |>
dplyr::mutate(QuanMZ = ifelse(Isotope_Label_Type == "Quan", Chromatogram_Precursor_MZ, NA)) |>
tidyr::fill(QuanMZ, .direction = "downup") |>
dplyr::mutate(QuanQualRatio = ifelse(Isotope_Label_Type == "Qual", Quan_Area/Area, 1)) |>
tidyr::replace_na(list(QuanQualRatio = 0)) |>
dplyr::mutate(QuanQualMZ = paste0(QuanMZ,"/",Chromatogram_Precursor_MZ)) |>
dplyr::mutate(Quan_Rel_Ab = ifelse(Isotope_Label_Type == "Quan", Rel_Ab, NA)) |>
tidyr::fill(Quan_Rel_Ab, .direction = "downup") |>
dplyr::mutate(QuanQual_Rel_Ab_Ratio = ifelse(Isotope_Label_Type == "Qual", Quan_Rel_Ab/Rel_Ab, 1)) |>
tidyr::replace_na(list(QuanQual_Rel_Ab_Ratio = 0)) |>
dplyr::ungroup() |>
dplyr::select(Replicate_Name, Sample_Type, Molecule_List, Molecule, QuanQualMZ, QuanQualRatio, QuanQual_Rel_Ab_Ratio) |>
plotly::plot_ly(x = ~Replicate_Name, y = ~QuanQualRatio/QuanQual_Rel_Ab_Ratio, type = 'violin', color = ~Sample_Type,
text = ~paste("Sample: ", Replicate_Name,
"<br>Molecule List: ", Molecule_List,
"<br>Molecule: ", Molecule,
"<br>Quan/Qual MZ: ", QuanQualMZ,
"<br>Ratio: ", round(QuanQualRatio/QuanQual_Rel_Ab_Ratio, 2)),
hoverinfo = "text") |>
plotly::layout(title = 'Ratio',
xaxis = list(title = 'Replicate Name'),
yaxis = list(title = 'Ratio'))
test <- Skyline_output_filt |>
dplyr::group_by(Replicate_Name, Molecule) |>
dplyr::mutate(Quan_Area = ifelse(Isotope_Label_Type == "Quan", Area, NA)) |>
tidyr::fill(Quan_Area, .direction = "downup") |>
dplyr::mutate(QuanMZ = ifelse(Isotope_Label_Type == "Quan", Chromatogram_Precursor_MZ, NA)) |>
tidyr::fill(QuanMZ, .direction = "downup") |>
dplyr::mutate(QuanQualRatio = ifelse(Isotope_Label_Type == "Qual", Quan_Area/Area, 1)) |>
tidyr::replace_na(list(QuanQualRatio = 0)) |>
dplyr::mutate(QuanQualMZ = paste0(QuanMZ,"/",Chromatogram_Precursor_MZ)) |>
dplyr::mutate(Quan_Rel_Ab = ifelse(Isotope_Label_Type == "Quan", Rel_Ab, NA)) |>
tidyr::fill(Quan_Rel_Ab, .direction = "downup") |>
dplyr::mutate(QuanQual_Rel_Ab_Ratio = ifelse(Isotope_Label_Type == "Qual", Quan_Rel_Ab/Rel_Ab, 1)) |>
tidyr::replace_na(list(QuanQual_Rel_Ab_Ratio = 0)) |>
dplyr::ungroup() |>
dplyr::mutate(Is_Outlier = QuanQualRatio/QuanQual_Rel_Ab_Rati > 3)
test <- Skyline_output_filt |>
dplyr::group_by(Replicate_Name, Molecule) |>
dplyr::mutate(Quan_Area = ifelse(Isotope_Label_Type == "Quan", Area, NA)) |>
tidyr::fill(Quan_Area, .direction = "downup") |>
dplyr::mutate(QuanMZ = ifelse(Isotope_Label_Type == "Quan", Chromatogram_Precursor_MZ, NA)) |>
tidyr::fill(QuanMZ, .direction = "downup") |>
dplyr::mutate(QuanQualRatio = ifelse(Isotope_Label_Type == "Qual", Quan_Area/Area, 1)) |>
tidyr::replace_na(list(QuanQualRatio = 0)) |>
dplyr::mutate(QuanQualMZ = paste0(QuanMZ,"/",Chromatogram_Precursor_MZ)) |>
dplyr::mutate(Quan_Rel_Ab = ifelse(Isotope_Label_Type == "Quan", Rel_Ab, NA)) |>
tidyr::fill(Quan_Rel_Ab, .direction = "downup") |>
dplyr::mutate(QuanQual_Rel_Ab_Ratio = ifelse(Isotope_Label_Type == "Qual", Quan_Rel_Ab/Rel_Ab, 1)) |>
tidyr::replace_na(list(QuanQual_Rel_Ab_Ratio = 0)) |>
dplyr::ungroup() |>
dplyr::mutate(Is_Outlier = QuanQualRatio/QuanQual_Rel_Ab_Ratio > 3)
View(test)
#     plotly::plot_ly(x = ~Replicate_Name, y = ~QuanQualRatio, type = 'violin', color = ~Sample_Type,
#             text = ~paste("Sample: ", Replicate_Name,
#                           "<br>Molecule List: ", Molecule_List,
#                           "<br>Molecule: ", Molecule,
#                           "<br>Quan/Qual MZ: ", QuanQualMZ,
#                           "<br>Ratio: ", round(QuanQualRatio, 2)),
#             hoverinfo = "text") |>
#     plotly::layout(title = 'Quan-to-Qual Ratio',
#            xaxis = list(title = 'Replicate Name'),
#            yaxis = list(title = 'Quan-to-Qual Ratio'))
test <- Skyline_output_filt |>
dplyr::group_by(Replicate_Name, Molecule) |>
dplyr::mutate(Quan_Area = ifelse(Isotope_Label_Type == "Quan", Area, NA)) |>
tidyr::fill(Quan_Area, .direction = "downup") |>
dplyr::mutate(QuanMZ = ifelse(Isotope_Label_Type == "Quan", Chromatogram_Precursor_MZ, NA)) |>
tidyr::fill(QuanMZ, .direction = "downup") |>
dplyr::mutate(QuanQualRatio = ifelse(Isotope_Label_Type == "Qual", Quan_Area/Area, 1)) |>
tidyr::replace_na(list(QuanQualRatio = 0)) |>
dplyr::mutate(QuanQualMZ = paste0(QuanMZ,"/",Chromatogram_Precursor_MZ)) |>
dplyr::mutate(Quan_Rel_Ab = ifelse(Isotope_Label_Type == "Quan", Rel_Ab, NA)) |>
tidyr::fill(Quan_Rel_Ab, .direction = "downup") |>
dplyr::mutate(QuanQual_Rel_Ab_Ratio = ifelse(Isotope_Label_Type == "Qual", Quan_Rel_Ab/Rel_Ab, 1)) |>
tidyr::replace_na(list(QuanQual_Rel_Ab_Ratio = 0)) |>
dplyr::ungroup() |>
dplyr::mutate(Is_Outlier = QuanQualRatio/QuanQual_Rel_Ab_Ratio > 3) |>
dplyr::select(Replicate_Name, Sample_Type, Molecule_List, Molecule, QuanQualMZ, QuanQualRatio, QuanQual_Rel_Ab_Ratio, Is_Outlier) |>
plotly::plot_ly(x = ~QuanQual_Rel_Ab_Ratio, y = ~QuanQualRatio,
type = 'scatter', mode = 'markers',
color = ~Is_Outlier,
colors = c('blue', 'red'),
text = ~paste("Replicate:", Replicate_Name,
"<br>Ratio:", round(ratio, 2)),
marker = list(size = 10)) %>%
layout(title = "Outlier Detection: QuanQualRatio vs QuanQual_Rel_Ab_Ratio",
xaxis = list(title = "QuanQual_Rel_Ab_Ratio"),
yaxis = list(title = "QuanQualRatio"))
#     plotly::plot_ly(x = ~Replicate_Name, y = ~QuanQualRatio, type = 'violin', color = ~Sample_Type,
#             text = ~paste("Sample: ", Replicate_Name,
#                           "<br>Molecule List: ", Molecule_List,
#                           "<br>Molecule: ", Molecule,
#                           "<br>Quan/Qual MZ: ", QuanQualMZ,
#                           "<br>Ratio: ", round(QuanQualRatio, 2)),
#             hoverinfo = "text") |>
#     plotly::layout(title = 'Quan-to-Qual Ratio',
#            xaxis = list(title = 'Replicate Name'),
#            yaxis = list(title = 'Quan-to-Qual Ratio'))
test <- Skyline_output_filt |>
dplyr::group_by(Replicate_Name, Molecule) |>
dplyr::mutate(Quan_Area = ifelse(Isotope_Label_Type == "Quan", Area, NA)) |>
tidyr::fill(Quan_Area, .direction = "downup") |>
dplyr::mutate(QuanMZ = ifelse(Isotope_Label_Type == "Quan", Chromatogram_Precursor_MZ, NA)) |>
tidyr::fill(QuanMZ, .direction = "downup") |>
dplyr::mutate(QuanQualRatio = ifelse(Isotope_Label_Type == "Qual", Quan_Area/Area, 1)) |>
tidyr::replace_na(list(QuanQualRatio = 0)) |>
dplyr::mutate(QuanQualMZ = paste0(QuanMZ,"/",Chromatogram_Precursor_MZ)) |>
dplyr::mutate(Quan_Rel_Ab = ifelse(Isotope_Label_Type == "Quan", Rel_Ab, NA)) |>
tidyr::fill(Quan_Rel_Ab, .direction = "downup") |>
dplyr::mutate(QuanQual_Rel_Ab_Ratio = ifelse(Isotope_Label_Type == "Qual", Quan_Rel_Ab/Rel_Ab, 1)) |>
tidyr::replace_na(list(QuanQual_Rel_Ab_Ratio = 0)) |>
dplyr::ungroup() |>
dplyr::mutate(Is_Outlier = QuanQualRatio/QuanQual_Rel_Ab_Ratio > 3) |>
dplyr::select(Replicate_Name, Sample_Type, Molecule_List, Molecule, QuanQualMZ, QuanQualRatio, QuanQual_Rel_Ab_Ratio, Is_Outlier) |>
plotly::plot_ly(x = ~QuanQual_Rel_Ab_Ratio, y = ~QuanQualRatio,
type = 'scatter', mode = 'markers',
color = ~Is_Outlier,
colors = c('blue', 'red'),
text = ~paste("Replicate:", Replicate_Name,
"<br>Ratio:", round(ratio, 2)),
marker = list(size = 10)) %>%
layout(title = "Outlier Detection: QuanQualRatio vs QuanQual_Rel_Ab_Ratio",
xaxis = list(title = "QuanQual_Rel_Ab_Ratio"),
yaxis = list(title = "QuanQualRatio"))
test
#     plotly::plot_ly(x = ~Replicate_Name, y = ~QuanQualRatio, type = 'violin', color = ~Sample_Type,
#             text = ~paste("Sample: ", Replicate_Name,
#                           "<br>Molecule List: ", Molecule_List,
#                           "<br>Molecule: ", Molecule,
#                           "<br>Quan/Qual MZ: ", QuanQualMZ,
#                           "<br>Ratio: ", round(QuanQualRatio, 2)),
#             hoverinfo = "text") |>
#     plotly::layout(title = 'Quan-to-Qual Ratio',
#            xaxis = list(title = 'Replicate Name'),
#            yaxis = list(title = 'Quan-to-Qual Ratio'))
Skyline_output_filt |>
dplyr::group_by(Replicate_Name, Molecule) |>
dplyr::mutate(Quan_Area = ifelse(Isotope_Label_Type == "Quan", Area, NA)) |>
tidyr::fill(Quan_Area, .direction = "downup") |>
dplyr::mutate(QuanMZ = ifelse(Isotope_Label_Type == "Quan", Chromatogram_Precursor_MZ, NA)) |>
tidyr::fill(QuanMZ, .direction = "downup") |>
dplyr::mutate(QuanQualRatio = ifelse(Isotope_Label_Type == "Qual", Quan_Area/Area, 1)) |>
tidyr::replace_na(list(QuanQualRatio = 0)) |>
dplyr::mutate(QuanQualMZ = paste0(QuanMZ,"/",Chromatogram_Precursor_MZ)) |>
dplyr::mutate(Quan_Rel_Ab = ifelse(Isotope_Label_Type == "Quan", Rel_Ab, NA)) |>
tidyr::fill(Quan_Rel_Ab, .direction = "downup") |>
dplyr::mutate(QuanQual_Rel_Ab_Ratio = ifelse(Isotope_Label_Type == "Qual", Quan_Rel_Ab/Rel_Ab, 1)) |>
tidyr::replace_na(list(QuanQual_Rel_Ab_Ratio = 0)) |>
dplyr::ungroup() |>
dplyr::mutate(Is_Outlier = QuanQualRatio/QuanQual_Rel_Ab_Ratio > 3) |>
dplyr::select(Replicate_Name, Sample_Type, Molecule_List, Molecule, QuanQualMZ, QuanQualRatio, QuanQual_Rel_Ab_Ratio, Is_Outlier) |>
plotly::plot_ly(x = ~QuanQual_Rel_Ab_Ratio, y = ~QuanQualRatio,
type = 'scatter', mode = 'markers',
color = ~Is_Outlier,
colors = c('blue', 'red'),
text = ~paste("Replicate:", Replicate_Name,
"<br>Ratio:", round(ratio, 2)),
marker = list(size = 10)) %>%
layout(title = "Outlier Detection: QuanQualRatio vs QuanQual_Rel_Ab_Ratio",
xaxis = list(title = "QuanQual_Rel_Ab_Ratio"),
yaxis = list(title = "QuanQualRatio"))
#     plotly::plot_ly(x = ~Replicate_Name, y = ~QuanQualRatio, type = 'violin', color = ~Sample_Type,
#             text = ~paste("Sample: ", Replicate_Name,
#                           "<br>Molecule List: ", Molecule_List,
#                           "<br>Molecule: ", Molecule,
#                           "<br>Quan/Qual MZ: ", QuanQualMZ,
#                           "<br>Ratio: ", round(QuanQualRatio, 2)),
#             hoverinfo = "text") |>
#     plotly::layout(title = 'Quan-to-Qual Ratio',
#            xaxis = list(title = 'Replicate Name'),
#            yaxis = list(title = 'Quan-to-Qual Ratio'))
Skyline_output_filt |>
dplyr::group_by(Replicate_Name, Molecule) |>
dplyr::mutate(Quan_Area = ifelse(Isotope_Label_Type == "Quan", Area, NA)) |>
tidyr::fill(Quan_Area, .direction = "downup") |>
dplyr::mutate(QuanMZ = ifelse(Isotope_Label_Type == "Quan", Chromatogram_Precursor_MZ, NA)) |>
tidyr::fill(QuanMZ, .direction = "downup") |>
dplyr::mutate(QuanQualRatio = ifelse(Isotope_Label_Type == "Qual", Quan_Area/Area, 1)) |>
tidyr::replace_na(list(QuanQualRatio = 0)) |>
dplyr::mutate(QuanQualMZ = paste0(QuanMZ,"/",Chromatogram_Precursor_MZ)) |>
dplyr::mutate(Quan_Rel_Ab = ifelse(Isotope_Label_Type == "Quan", Rel_Ab, NA)) |>
tidyr::fill(Quan_Rel_Ab, .direction = "downup") |>
dplyr::mutate(QuanQual_Rel_Ab_Ratio = ifelse(Isotope_Label_Type == "Qual", Quan_Rel_Ab/Rel_Ab, 1)) |>
tidyr::replace_na(list(QuanQual_Rel_Ab_Ratio = 0)) |>
dplyr::ungroup() |>
dplyr::mutate(Is_Outlier = QuanQualRatio/QuanQual_Rel_Ab_Ratio > 3) |>
dplyr::select(Replicate_Name, Sample_Type, Molecule_List, Molecule, QuanQualMZ, QuanQualRatio, QuanQual_Rel_Ab_Ratio, Is_Outlier) |>
plotly::plot_ly(x = ~QuanQual_Rel_Ab_Ratio, y = ~QuanQualRatio,
type = 'scatter', mode = 'markers',
color = ~Is_Outlier,
colors = c('blue', 'red'),
text = ~paste("Replicate:", Replicate_Name,
"<br>Ratio:", round(QuanQualRatio, 2)),
marker = list(size = 10)) %>%
layout(title = "Outlier Detection: QuanQualRatio vs QuanQual_Rel_Ab_Ratio",
xaxis = list(title = "QuanQual_Rel_Ab_Ratio"),
yaxis = list(title = "QuanQualRatio"))
#     plotly::plot_ly(x = ~Replicate_Name, y = ~QuanQualRatio, type = 'violin', color = ~Sample_Type,
#             text = ~paste("Sample: ", Replicate_Name,
#                           "<br>Molecule List: ", Molecule_List,
#                           "<br>Molecule: ", Molecule,
#                           "<br>Quan/Qual MZ: ", QuanQualMZ,
#                           "<br>Ratio: ", round(QuanQualRatio, 2)),
#             hoverinfo = "text") |>
#     plotly::layout(title = 'Quan-to-Qual Ratio',
#            xaxis = list(title = 'Replicate Name'),
#            yaxis = list(title = 'Quan-to-Qual Ratio'))
Skyline_output_filt |>
dplyr::group_by(Replicate_Name, Molecule) |>
dplyr::mutate(Quan_Area = ifelse(Isotope_Label_Type == "Quan", Area, NA)) |>
tidyr::fill(Quan_Area, .direction = "downup") |>
dplyr::mutate(QuanMZ = ifelse(Isotope_Label_Type == "Quan", Chromatogram_Precursor_MZ, NA)) |>
tidyr::fill(QuanMZ, .direction = "downup") |>
dplyr::mutate(QuanQualRatio = ifelse(Isotope_Label_Type == "Qual", Quan_Area/Area, 1)) |>
tidyr::replace_na(list(QuanQualRatio = 0)) |>
dplyr::mutate(QuanQualMZ = paste0(QuanMZ,"/",Chromatogram_Precursor_MZ)) |>
dplyr::mutate(Quan_Rel_Ab = ifelse(Isotope_Label_Type == "Quan", Rel_Ab, NA)) |>
tidyr::fill(Quan_Rel_Ab, .direction = "downup") |>
dplyr::mutate(QuanQual_Rel_Ab_Ratio = ifelse(Isotope_Label_Type == "Qual", Quan_Rel_Ab/Rel_Ab, 1)) |>
tidyr::replace_na(list(QuanQual_Rel_Ab_Ratio = 0)) |>
dplyr::ungroup() |>
dplyr::mutate(Is_Outlier = QuanQualRatio/QuanQual_Rel_Ab_Ratio > 3) |>
dplyr::select(Replicate_Name, Sample_Type, Molecule_List, Molecule, QuanQualMZ, QuanQualRatio, QuanQual_Rel_Ab_Ratio, Is_Outlier) |>
plotly::plot_ly(x = ~Replicate_Name, y = ~QuanQualRatio,
type = 'scatter', mode = 'markers',
color = ~Is_Outlier,
colors = c('blue', 'red'),
text = ~paste("Replicate:", Replicate_Name,
"<br>Ratio:", round(QuanQualRatio, 2)),
marker = list(size = 10)) %>%
layout(title = "Outlier Detection: QuanQualRatio vs QuanQual_Rel_Ab_Ratio",
xaxis = list(title = "QuanQual_Rel_Ab_Ratio"),
yaxis = list(title = "QuanQualRatio"))
#     plotly::plot_ly(x = ~Replicate_Name, y = ~QuanQualRatio, type = 'violin', color = ~Sample_Type,
#             text = ~paste("Sample: ", Replicate_Name,
#                           "<br>Molecule List: ", Molecule_List,
#                           "<br>Molecule: ", Molecule,
#                           "<br>Quan/Qual MZ: ", QuanQualMZ,
#                           "<br>Ratio: ", round(QuanQualRatio, 2)),
#             hoverinfo = "text") |>
#     plotly::layout(title = 'Quan-to-Qual Ratio',
#            xaxis = list(title = 'Replicate Name'),
#            yaxis = list(title = 'Quan-to-Qual Ratio'))
Skyline_output_filt |>
dplyr::group_by(Replicate_Name, Molecule) |>
dplyr::mutate(Quan_Area = ifelse(Isotope_Label_Type == "Quan", Area, NA)) |>
tidyr::fill(Quan_Area, .direction = "downup") |>
dplyr::mutate(QuanMZ = ifelse(Isotope_Label_Type == "Quan", Chromatogram_Precursor_MZ, NA)) |>
tidyr::fill(QuanMZ, .direction = "downup") |>
dplyr::mutate(QuanQualRatio = ifelse(Isotope_Label_Type == "Qual", Quan_Area/Area, 1)) |>
tidyr::replace_na(list(QuanQualRatio = 0)) |>
dplyr::mutate(QuanQualMZ = paste0(QuanMZ,"/",Chromatogram_Precursor_MZ)) |>
dplyr::mutate(Quan_Rel_Ab = ifelse(Isotope_Label_Type == "Quan", Rel_Ab, NA)) |>
tidyr::fill(Quan_Rel_Ab, .direction = "downup") |>
dplyr::mutate(QuanQual_Rel_Ab_Ratio = ifelse(Isotope_Label_Type == "Qual", Quan_Rel_Ab/Rel_Ab, 1)) |>
tidyr::replace_na(list(QuanQual_Rel_Ab_Ratio = 0)) |>
dplyr::ungroup() |>
dplyr::mutate(Is_Outlier = QuanQualRatio/QuanQual_Rel_Ab_Ratio > 3) |>
dplyr::select(Replicate_Name, Sample_Type, Molecule_List, Molecule, QuanQualMZ, QuanQualRatio, QuanQual_Rel_Ab_Ratio, Is_Outlier) |>
plotly::plot_ly(x = ~Replicate_Name, y = ~QuanQualRatio,
type = 'scatter', mode = 'markers',
color = ~Is_Outlier,
colors = c('blue', 'red'),
text = ~paste("Replicate:", Replicate_Name,
"<br>Homologue Group: ", Molecule,
"<br>Ratio:", round(QuanQualRatio/QuanQual_Rel_Ab_Ratio, 2)),
marker = list(size = 10)) %>%
layout(title = "Outlier Detection: QuanQualRatio vs QuanQual_Rel_Ab_Ratio",
xaxis = list(title = "QuanQual_Rel_Ab_Ratio"),
yaxis = list(title = "QuanQualRatio"))
#     plotly::plot_ly(x = ~Replicate_Name, y = ~QuanQualRatio, type = 'violin', color = ~Sample_Type,
#             text = ~paste("Sample: ", Replicate_Name,
#                           "<br>Molecule List: ", Molecule_List,
#                           "<br>Molecule: ", Molecule,
#                           "<br>Quan/Qual MZ: ", QuanQualMZ,
#                           "<br>Ratio: ", round(QuanQualRatio, 2)),
#             hoverinfo = "text") |>
#     plotly::layout(title = 'Quan-to-Qual Ratio',
#            xaxis = list(title = 'Replicate Name'),
#            yaxis = list(title = 'Quan-to-Qual Ratio'))
Skyline_output_filt |>
dplyr::group_by(Replicate_Name, Molecule) |>
dplyr::mutate(Quan_Area = ifelse(Isotope_Label_Type == "Quan", Area, NA)) |>
tidyr::fill(Quan_Area, .direction = "downup") |>
dplyr::mutate(QuanMZ = ifelse(Isotope_Label_Type == "Quan", Chromatogram_Precursor_MZ, NA)) |>
tidyr::fill(QuanMZ, .direction = "downup") |>
dplyr::mutate(QuanQualRatio = ifelse(Isotope_Label_Type == "Qual", Quan_Area/Area, 1)) |>
tidyr::replace_na(list(QuanQualRatio = 0)) |>
dplyr::mutate(QuanQualMZ = paste0(QuanMZ,"/",Chromatogram_Precursor_MZ)) |>
dplyr::mutate(Quan_Rel_Ab = ifelse(Isotope_Label_Type == "Quan", Rel_Ab, NA)) |>
tidyr::fill(Quan_Rel_Ab, .direction = "downup") |>
dplyr::mutate(QuanQual_Rel_Ab_Ratio = ifelse(Isotope_Label_Type == "Qual", Quan_Rel_Ab/Rel_Ab, 1)) |>
tidyr::replace_na(list(QuanQual_Rel_Ab_Ratio = 0)) |>
dplyr::ungroup() |>
dplyr::mutate(Is_Outlier = QuanQualRatio/QuanQual_Rel_Ab_Ratio > 3) |>
dplyr::select(Replicate_Name, Sample_Type, Molecule_List, Molecule, QuanQualMZ, QuanQualRatio, QuanQual_Rel_Ab_Ratio, Is_Outlier) |>
plotly::plot_ly(x = ~Replicate_Name, y = ~QuanQualRatio,
type = 'scatter', mode = 'markers',
color = ~Is_Outlier,
colors = c('blue', 'red'),
text = ~paste("Replicate:", Replicate_Name,
"<br>Homologue Group: ", Molecule,
"<br>Measured against Theoretical Ratio:", round(QuanQualRatio/QuanQual_Rel_Ab_Ratio, 2)),
marker = list(size = 10)) %>%
layout(title = "QuanQualRatio: Measured divided by Theoretical (>3 marked in red)",
xaxis = list(title = "QuanQual_Rel_Ab_Ratio"),
yaxis = list(title = "QuanQualRatio"))
devtools::load_all()
CPquant()
devtools::load_all()
CPquant()
devtools::load_all()
CPquant()
devtools::load_all()
CPquant()
devtools::load_all()
CPquant()
devtools::load_all()
CPquant()
devtools::load_all()
CPquant()
devtools::load_all()
CPquant()
devtools::load_all()
CPion()
CPions()
devtools::load_all()
CPions()
CPquant()
warnings()
devtools::load_all()
library(devtools)
document()
check()
warnings()
devtools::load_all()
CPions()
check()
devtools::check()
devtools::document()
